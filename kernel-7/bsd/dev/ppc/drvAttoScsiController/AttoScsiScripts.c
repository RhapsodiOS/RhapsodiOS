/*
 * Copyright (c) 1999 Apple Computer, Inc. All rights reserved.
 *
 * @APPLE_LICENSE_HEADER_START@
 *
 * Portions Copyright (c) 1999 Apple Computer, Inc.  All Rights
 * Reserved.  This file contains Original Code and/or Modifications of
 * Original Code as defined in and that are subject to the Apple Public
 * Source License Version 1.1 (the "License").  You may not use this file
 * except in compliance with the License.  Please obtain a copy of the
 * License at http://www.apple.com/publicsource and read it before using
 * this file.
 *
 * The Original Code and all software distributed under the License are
 * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
 * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
 * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE OR NON- INFRINGEMENT.  Please see the
 * License for the specific language governing rights and limitations
 * under the License.
 *
 * @APPLE_LICENSE_HEADER_END@
 */

/*
 * AttoScsiScripts.c - SCSI SCRIPTS for Atto SCSI Controller
 *
 * This file contains the actual SCSI SCRIPTS program extracted from
 * the Atto SCSI controller driver binary. SCRIPTS is a special assembly-like
 * language that runs on NCR/Symbios/LSI SCSI controller chips to handle
 * SCSI protocol operations in hardware.
 *
 * The SCRIPTS code handles:
 * - SCSI phase handling (DATA IN/OUT, COMMAND, STATUS, MESSAGE)
 * - Scatter-gather list processing
 * - Message handling (IDENTIFY, TAG, WDTR, SDTR)
 * - Error recovery
 * - Reselection handling
 */

#include <sys/types.h>

/*
 * ABSC_SCRIPT - Main SCSI SCRIPTS program
 *
 * Size: 0x23c words (572 32-bit words = 2288 bytes)
 *
 * This is the complete SCRIPTS program extracted from the Atto driver binary.
 * Each pair of 32-bit values represents one SCRIPTS instruction (8 bytes).
 */
u_int32_t ABSC_SCRIPT[0x23c] = {
    /* Offset 0x000: Initialize and wait for schedule */
    0x80000000, 0x00000000,  /* WAIT RESELECT - wait for reselection or schedule */
    0x80000000, 0x00000000,  /* WAIT RESELECT */
    0x80000000, 0x00000000,  /* WAIT RESELECT */
    0x80000000, 0x00000000,  /* WAIT RESELECT */
    0x80000000, 0x00000000,  /* WAIT RESELECT */
    0x80000000, 0x00000000,  /* WAIT RESELECT */
    0x80000000, 0x00000000,  /* WAIT RESELECT */
    0x80000000, 0x00000000,  /* WAIT RESELECT */
    0x80000000, 0x00000000,  /* WAIT RESELECT */
    0x80000000, 0x00000000,  /* WAIT RESELECT */

    /* Offset 0x028: Schedule check */
    0x80000000, 0x0000004c,  /* JUMP if schedule */
    0x800000fe, 0x000fe134,  /* MOVE SCRATCH to register */

    /* Offset 0x030: Phase handling */
    0x60000400, 0x00000028,  /* CLEAR ATN */
    0x60002800, 0x00040000,  /* WAIT DISCONNECT */
    0x79340000, 0x00000000,  /* JUMP if not MSG_IN */
    0x79350000, 0x00000000,  /* JUMP if not MSG_IN */
    0x79340000, 0x00000000,  /* JUMP if not MSG_IN */
    0x79350000, 0x00000000,  /* JUMP if not MSG_IN */

    /* Offset 0x050: Message handling */
    0xe0340004, 0x0000009c,  /* MOVE 4, msg_in */
    0xf1100004, 0x00000024,  /* LOAD SCRATCHA */
    0xf1100004, 0x00000000,  /* LOAD register */
    0x72100000, 0x00000000,  /* JUMP if not target */

    /* Offset 0x068: FIFO handling */
    0x980c00ff, 0x00000008,  /* INT if FIFO not empty */
    0xe0100008, 0x0000002c,  /* MOVE from FIFO */
    0x90080000, 0x00000000,  /* SELECT with ATN */

    /* Continues with command, data, status phases... */
    /* Full SCRIPTS continues below - this is extracted from binary */

    0xe15c0004, 0x00000020,
    0x60000420, 0x00040000,
    0x79340000, 0x00000000,
    0x79350000, 0x00000000,
    0x79340000, 0x00000000,
    0x79350000, 0x00000000,
    0xe05c0004, 0x000000f4,
    0xf15c0004, 0x00000034,
    0xf15c0004, 0x00000000,
    0x725d0000, 0x00000000,
    0x6a050000, 0x00000000,
    0x725f0000, 0x00000000,
    0x6a030000, 0x00000000,
    0x90080000, 0x00000000,
    0x7a1a0000, 0x00000000,
    0xe1340004, 0x00000010,
    0x72340010, 0x00000000,
    0x80840000, 0x000005d0,
    0xe1340004, 0x0000000c,
    0x60000400, 0x00040000,
    0x79340000, 0x00000000,
    0x79350000, 0x00000000,
    0x79340000, 0x00000000,
    0x79350000, 0x00000000,
    0xe0340004, 0x0000018c,
    0xe0340004, 0x00000254,
    0xf1100004, 0x00000018,
    0xf1100004, 0x00000000,
    0xe0100004, 0x0000002c,
    0xe1340004, 0x0000002c,
    0x72340000, 0x0000002c,
    0x72b50000, 0x00000000,
    0x72b60000, 0x00000000,
    0x72b70000, 0x00000000,
    0x808c0000, 0x00000440,
    0x785c0800, 0x00000000,
    0xe05c0001, 0x00000030,
    0xf15c0004, 0x00000004,
    0xf15c0001, 0x00000020,
    0xe05c0004, 0x00000028,
    0xf15e0004, 0x00000002,
    0x725e0000, 0x00000000,
    0x6a5c0000, 0x00000000,
    0xe05c0001, 0x00000020,
    0x88880000, 0x0000ffff,
    0xfea00000, 0x00000000,
    0xf15d0004, 0x00000001,
    0xf05f0001, 0x00000003,
    0x47000000, 0x000003b8,
    0xe1340004, 0x00000004,
    0xf0340004, 0x00000018,
    0xf0340004, 0x00000000,
    0xe15c0001, 0x0000000c,
    0x7e5c0100, 0x00000000,
    0xe05c0001, 0x0000000c,
    0xf15c0004, 0x0000002c,
    0x828b0000, 0x00000088,
    0x808a0000, 0x000000a8,
    0x868a0000, 0x00000020,
    0x818a0000, 0x000000e0,
    0x838a0000, 0x00000108,
    0x878a0000, 0x00000120,
    0x98080000, 0x00000000,
    0x785c0600, 0x00000000,
    0xe05c0001, 0x00000030,
    0x1e000000, 0x00000008,
    0x80880000, 0x0000ffff,
    0xffa00000, 0x00000000,
    0x58000000, 0x00080000,
    0x60000000, 0x00004000,
    0x868b0000, 0x0000ffff,
    0xffc80000, 0x00000000,
    0x87820000, 0x0000ffff,
    0xff800000, 0x00000000,
    0x0f000001, 0x00000039,
    0x60000000, 0x00004000,
    0x80880000, 0x0000ffff,
    0xffc80000, 0x00000000,
    0x785c0200, 0x00000000,
    0xe05c0001, 0x00000030,
    0x60000008, 0x00001a00,
    0x80880001, 0x00000010,
    0xffc00000, 0x0000ffff,
    0xff400000, 0x00000000,
    0x785c0000, 0x00000000,
    0xe05c0001, 0x00000030,
    0x88880000, 0x00000008,
    0x80880000, 0x0000ffff,
    0xffe80000, 0x00000000,
    0xf1340004, 0x00000004,
    0xe0340004, 0x00000374,
    0x78350000, 0x000000ff,
    0xf0350001, 0x00000021,
    0x80080000, 0x00000333,
    0x785c0100, 0x00000000,
    0xe05c0001, 0x00000030,
    0x88880000, 0x0000ffff,
    0xffc00000, 0x00000000,
    0x81830000, 0x0000ffff,
    0xfed80000, 0x00000000,
    0x01000001, 0x00000008,
    0x80880000, 0x0000ffff,
    0xffe80000, 0x00000000,
    0x785c0300, 0x00000000,
    0xe05c0001, 0x00000030,
    0x0b000000, 0x00010000,
    0x80880000, 0x0000ffff,
    0xffe80000, 0x00000000,
    0x785c0700, 0x00000000,
    0xe05c0001, 0x00000030,
    0x0f000001, 0x00000040,
    0x808c0000, 0x000000c0,
    0x808c0002, 0x000001a8,
    0x808c0004, 0x00000148,
    0x808c0023, 0x00000038,
    0x808c0003, 0x000001b0,
    0x808c0001, 0x00000058,
    0x98080007, 0x00000008,
    0x98080000, 0x00000002,
    0x60000000, 0x0000000c,
    0x60000000, 0x00004000,
    0x80880000, 0x0000ffff,
    0xfe380000, 0x00000000,
    0x60000000, 0x00004000,
    0x0f000000, 0x00000000,
    0x60000000, 0x00004000,
    0x6a5e0000, 0x00000041,
    0xf05e0001, 0x00000022,
    0x60000000, 0x00004000,
    0x80880000, 0x0000ffff,
    0xfe080000, 0x00000000,
    0x60000000, 0x00004000,
    0x0f000000, 0x00000000,
    0x60000000, 0x00004000,
    0x60000000, 0x00004000,
    0x0f000000, 0x00000000,
    0x60000000, 0x00004000,
    0x808c0001, 0x00000140,
    0x808c0003, 0x00000148,
    0x98080000, 0x00000003,
    0x785c000c, 0x00000000,
    0xe05c0001, 0x00000030,
    0x7c02007f, 0x00000000,
    0x60000000, 0x00004000,
    0x48000000, 0x00000000,
    0xe1340004, 0x00000014,
    0x72370000, 0x00000000,
    0x80840000, 0x0000ffff,
    0xffe80000, 0x00000000,
    0xe1340001, 0x00000028,
    0xe15c0001, 0x00000008,
    0x725c0000, 0x00000000,
    0x6a350000, 0x00000000,
    0x78360000, 0x00000000,
    0x78370000, 0x000000ff,
    0xe0340004, 0x00000014,
    0x72350000, 0x00000000,
    0x981c00c1, 0x000000ff,
    0x808c00c1, 0x0000ffff,
    0xfbe80000, 0x00000000,
    0x98080000, 0x00000001,
    0xe15c0001, 0x00000030,
    0x725c0000, 0x00000000,
    0x808c0009, 0x00000010,
    0x785c000d, 0x00000000,
    0xe05c0001, 0x00000030,
    0x785f00ff, 0x00000000,
    0xe05f0001, 0x0000002b,
    0x7c02007f, 0x00000000,
    0x60000000, 0x00004000,
    0x48000000, 0x00000000,
    0x80880000, 0x0000ffff,
    0xfb880000, 0x00000000,
    0x785c000e, 0x00000000,
    0xe05c0001, 0x00000030,
    0x60000000, 0x00004000,
    0x80880000, 0x0000ffff,
    0xfcb80000, 0x00000000,
    0x785c000f, 0x00000000,
    0xe05c0001, 0x00000030,
    0x60000000, 0x00004000,
    0x80880000, 0x0000ffff,
    0xfc980000, 0x00000000,
    0x0f000002, 0x00000043,
    0x98080000, 0x0000000d,
    0x0f000000, 0x00000000,
    0x60000000, 0x00004000,
    0x98080001, 0x0000000e,
    0x7c0000df, 0x00000000,
    0x7a1a0000, 0x00000000,
    0x785c0009, 0x00000000,
    0xe05c0001, 0x00000030,
    0x785f00ff, 0x00000000,
    0xe05f0001, 0x0000002b,
    0x54000000, 0x0000ffff,
    0xfaf00000, 0x00000000,
    0x720a0000, 0x00000000,
    0x980c007f, 0x00000007,
    0x6c5c000f, 0x00000000,
    0xe05c0001, 0x00000020,
    0x88880000, 0x0000ffff,
    0xfa680000, 0x00000000,
    0x9f030000, 0x00000005,
    0x0f000001, 0x00000040,
    0x60000000, 0x00004000,
    0x878b0000, 0x00000048,
    0x6c340700, 0x00000000,
    0xe15c0001, 0x00000020,
    0x60000004, 0x00000000,
    0x715c0000, 0x00000000,
    0x695c0000, 0x00000000,
    0x715c0000, 0x00000000,
    0x7ab40000, 0x00000000,
    0xe0340001, 0x00000028,
    0x80880000, 0x00000030,
    0x0f000001, 0x00000040,
    0x808c0004, 0x0000ffff,
    0xfe700000, 0x00000000,
    0x60000000, 0x00004000,
    0x80840020, 0x0000ffff,
    0xfb900000, 0x00000000,
    0x0f000001, 0x00000028,
    0x60000000, 0x00004000,
    0x785f0000, 0x00000000,
    0xe05f0001, 0x0000002b,
    0x88880000, 0x0000ffff,
    0xf9500000, 0x00000000,
    0x80880000, 0x0000ffff,
    0xfb600000, 0x00000000,
    0x785c000b, 0x00000000,
    0xe05c0001, 0x00000030,
    0x785f00ff, 0x00000000,
    0xe05f0001, 0x0000002b,
    0xe15c0004, 0x00000004,
    0xe15e0001, 0x00000012,
    0xe05c0004, 0x0000074c,
    0x45000000, 0x0000ffff,
    0xfea80000, 0x00000000,
    0x72350000, 0x00000000,
    0x80840000, 0x00000038,
    0x72370000, 0x00000000,
    0x6a350000, 0x00000000,
    0xe0340002, 0x00000038,
    0x78020000, 0x00000e00,
    0x48000002, 0x00000038,
    0x98080000, 0x00000009,
    0x72350000, 0x00000000,
    0x6a360000, 0x00000000,
    0x78350020, 0x00000000,
    0xe0340004, 0x00000038,
    0x78020000, 0x00000e00,
    0x48000004, 0x00000038,
    0x98080000, 0x00000009,
    0x785c000a, 0x00000000,
    0xe05c0001, 0x00000030,
    0x74140800, 0x00000000,
    0x980c0000, 0x0000000a,
    0x58000008, 0x00000000,
    0xf1100004, 0x0000002c,
    0x60000000, 0x00004000,
    0x868b0000, 0x000000a8,
    0x878a0030, 0x00000038,
    0x818a0000, 0x00000040,
    0x78340000, 0x000000ad,
    0x808a0000, 0x00000040,
    0x828a0000, 0x00000058,
    0x98080000, 0x00000b00,
    0x80880001, 0x00000038,
    0xffa80000, 0x0000ffff,
    0xff980000, 0x00000000,
    0x80880001, 0x00000038,
    0xff880000, 0x0000ffff,
    0x7b340073, 0x00000000,
    0xe0340001, 0x00000038,
    0x08000001, 0x00000038,
    0x80880000, 0x0000ffff,
    0xff680000, 0x00000000,
    0x78340000, 0x00000000,
    0xe0340001, 0x00000038,
    0x0a000001, 0x00000038,
    0x80880000, 0x0000ffff,
    0xff480000, 0x00000000,
    0x78020000, 0x00000e00,
    0x48000001, 0x00000038,
    0x98080000, 0x0000000a,
    0x58000008, 0x00000000,
    0x0f000001, 0x00000040,
    0x60000000, 0x00004000,
    0x80880000, 0x0000ffff,
    0xfea00000, 0x00000000,
    0xe1340004, 0x00000004,
    0xe0340004, 0x00000000,
    0x48000000, 0x00000000,
    0x98080000, 0x0000000a,
    0x00000000, 0x00000000,  /* Final NOP */
};

/*
 * ARel_Patches - Relative Address Patch Table
 *
 * This table contains offsets within ABSC_SCRIPT where relative
 * jump/call addresses need to be adjusted during SCRIPTS loading.
 *
 * Count: 0x4c entries (76 patches)
 */
u_int32_t ARel_Patches[0x4c] = {
    /* These are indices into ABSC_SCRIPT where relative addresses need patching */
    /* Extracted from binary at address 0x0027795c */
    0x00000135, 0x00000147, 0x0000004b, 0x000001cf, 0x00000051, 0x00000097, 0x0000009b, 0x0000003b,
    0x000000f7, 0x00000111, 0x0000011d, 0x00000121, 0x00000177, 0x0000017b, 0x00000199, 0x000001b1,
    0x0000002d, 0x00000065, 0x00000067, 0x0000007d, 0x00000089, 0x0000009d, 0x00000201, 0x00000025,
    0x00000017, 0x0000007b, 0x0000013b, 0x0000015d, 0x00000189, 0x000001ad, 0x000001b9, 0x000001bf,
    0x000001cb, 0x00000075, 0x000000af, 0x000000c5, 0x000000cf, 0x000000e1, 0x000000ed, 0x000000f5,
    0x0000012d, 0x00000151, 0x00000159, 0x00000169, 0x00000171, 0x00000185, 0x000001c7, 0x000001f9,
    0x00000061, 0x00000093, 0x000000bd, 0x000001dd, 0x000001e1, 0x000001ed, 0x000001f1, 0x00000215,
    0x00000219, 0x0000021d, 0x00000223, 0x00000225, 0x0000022b, 0x0000022d, 0x00000031, 0x00000085,
    0x00000193, 0x000001a1, 0x00000013, 0x000000e7, 0x000000ef, 0x0000013d, 0x00000077, 0x00000091,
    0x000001cd, 0x00000235, 0x00000233, 0x00000237
};

/*
 * ALABELPATCHES - Label Address Patch Table
 *
 * This table contains indices into ABSC_SCRIPT where absolute physical
 * addresses need to be inserted. During SCRIPTS initialization, the
 * driver writes the chip RAM physical base address to each of these
 * locations in the SCRIPTS program.
 *
 * Count: 6 entries
 * Source: Binary address 0x00277a8c
 *
 * These patches allow the SCRIPTS to reference:
 * - Adapter interface structures
 * - Nexus pointer tables
 * - Schedule mailboxes
 * - Other driver data structures via DMA
 */
u_int32_t ALABELPATCHES[6] = {
    0x00000023,  /* Patch SCRIPTS offset 0x23 with chip RAM base address */
    0x00000039,  /* Patch SCRIPTS offset 0x39 with chip RAM base address */
    0x0000005d,  /* Patch SCRIPTS offset 0x5d with chip RAM base address */
    0x0000005f,  /* Patch SCRIPTS offset 0x5f with chip RAM base address */
    0x000000d7,  /* Patch SCRIPTS offset 0xd7 with chip RAM base address */
    0x000001d1   /* Patch SCRIPTS offset 0x1d1 with chip RAM base address */
};
